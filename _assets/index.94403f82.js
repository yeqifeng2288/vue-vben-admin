import{P as t,a as e,z as n,C as i,K as r,J as s,H as o,bc as a,k as u,L as c,G as l,ba as h,E as p,am as f,_ as d,r as v,Q as m,F as b,I as g,M as y}from"./index.2a9ceb8a.js";import{D as O}from"./DownOutlined.cbacc8d2.js";import{U as w}from"./UpOutlined.92c78b2f.js";function x(){return(x=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var C=e({name:"TouchFeedback",mixins:[n],inheritAttrs:!1,props:i({disabled:t.looseBool,activeClassName:t.string,activeStyle:t.any},{disabled:!1}),data:function(){return this.child=null,{active:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.disabled&&t.active&&t.setState({active:!1})}))},methods:{triggerEvent:function(t,e,n){var i="on".concat(t),r=this.child;r.props[i]&&r.props[i](n),e!==this.active&&this.setState({active:e})},onTouchStart:function(t){this.triggerEvent("Touchstart",!0,t)},onTouchMove:function(t){this.triggerEvent("Touchmove",!1,t)},onTouchEnd:function(t){this.triggerEvent("Touchend",!1,t)},onTouchCancel:function(t){this.triggerEvent("Touchcancel",!1,t)},onMouseDown:function(t){this.triggerEvent("Mousedown",!0,t)},onMouseUp:function(t){this.triggerEvent("Mouseup",!1,t)},onMouseLeave:function(t){this.triggerEvent("Mouseleave",!1,t)}},render:function(){var t=this.$props,e=t.disabled,n=t.activeClassName,i=void 0===n?"":n,u=t.activeStyle,c=void 0===u?{}:u,l=r(this);if(1!==l.length)return s(!1,"m-feedback组件只能包含一个子元素"),null;var h=e?void 0:{onTouchstart:this.onTouchStart,onTouchmove:this.onTouchMove,onTouchend:this.onTouchEnd,onTouchcancel:this.onTouchCancel,onMousedown:this.onMouseDown,onMouseup:this.onMouseUp,onMouseleave:this.onMouseLeave};if(l=l[0],this.child=l,!e&&this.active){var p=l.props,f=p.style,d=p.class;return!1!==c&&(c&&(f=x(x({},f),c)),d=o(d,i)),a(l,x({class:d,style:f},h))}return a(l,h)}});var P={name:"InputHandler",inheritAttrs:!1,props:{prefixCls:t.string,disabled:t.looseBool},render:function(){var t,e,n=this.$props,i=n.prefixCls,s={disabled:n.disabled,activeClassName:"".concat(i,"-handler-active")};return u(C,s,"function"==typeof(e=t=u("span",this.$attrs,[r(this)]))||"[object Object]"===Object.prototype.toString.call(e)&&!c(e)?t:{default:function(){return[t]}})}};function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(){return(N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function T(t){t.preventDefault()}var E=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,j=function(t){return null!=t},D=function(t,e){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},_=e({name:"VCInputNumber",mixins:[n],inheritAttrs:!1,props:i({value:t.oneOfType([t.number,t.string]),defaultValue:t.oneOfType([t.number,t.string]),focusOnUpDown:t.looseBool,autofocus:t.looseBool,prefixCls:t.string,tabindex:t.oneOfType([t.string,t.number]),placeholder:t.string,disabled:t.looseBool,readonly:t.looseBool,max:t.number,min:t.number,step:t.oneOfType([t.number,t.string]),upHandler:t.any,downHandler:t.any,useTouch:t.looseBool,formatter:t.func,parser:t.func,precision:t.number,required:t.looseBool,pattern:t.string,decimalSeparator:t.string,autocomplete:t.string,title:t.string,name:t.string,id:t.string,type:t.string,maxlength:t.any},{focusOnUpDown:!0,useTouch:!1,prefixCls:"rc-input-number",min:-E,step:1,parser:function(t){return t.replace(/[^\w\.-]+/g,"")},required:!1,autocomplete:"off"}),data:function(){var t,e=l(this);this.prevProps=N({},e),t="value"in e?this.value:this.defaultValue;var n=this.getValidValue(this.toNumber(t));return{inputValue:this.toPrecisionAsStep(n),sValue:n,focused:this.autofocus}},mounted:function(){var t=this;this.$nextTick((function(){t.updatedFunc()}))},updated:function(){var t=this,e=this.$props,n=e.value,i=e.max,r=e.min,s=this.$data.focused,o=this.prevProps,a=l(this);if(o){if(!D(o.value,n)||!D(o.max,i)||!D(o.min,r)){var u,c=s?n:this.getValidValue(n);u=this.pressingUpOrDown?c:this.inputting?this.rawInput:this.toPrecisionAsStep(c),this.setState({sValue:c,inputValue:u})}var h="value"in a?n:this.$data.sValue;"max"in a&&o.max!==i&&"number"==typeof h&&h>i&&(this.__emit("update:value",i),this.__emit("change",i)),"min"in a&&o.min!==r&&"number"==typeof h&&h<r&&(this.__emit("update:value",r),this.__emit("change",r))}this.prevProps=N({},a),this.$nextTick((function(){t.updatedFunc()}))},beforeUnmount:function(){this.stop()},methods:{updatedFunc:function(){var t=this.inputRef;try{if(void 0!==this.cursorStart&&this.$data.focused)if(this.partRestoreByAfter(this.cursorAfter)||this.$data.sValue===this.value){if(this.currentValue===t.value)switch(this.lastKeyCode){case h.BACKSPACE:this.fixCaret(this.cursorStart-1,this.cursorStart-1);break;case h.DELETE:this.fixCaret(this.cursorStart+1,this.cursorStart+1)}}else{var e=this.cursorStart+1;this.cursorAfter?this.lastKeyCode===h.BACKSPACE?e=this.cursorStart-1:this.lastKeyCode===h.DELETE&&(e=this.cursorStart):e=t.value.length,this.fixCaret(e,e)}}catch(t){}this.lastKeyCode=null,this.pressingUpOrDown&&(this.focusOnUpDown&&this.$data.focused&&document.activeElement!==t&&this.focus(),this.pressingUpOrDown=!1)},onKeyDown:function(t){if(t.keyCode===h.UP){var e=this.getRatio(t);this.up(t,e),this.stop()}else if(t.keyCode===h.DOWN){var n=this.getRatio(t);this.down(t,n),this.stop()}else t.keyCode===h.ENTER&&this.__emit("pressEnter",t);this.recordCursorPosition(),this.lastKeyCode=t.keyCode;for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];this.__emit.apply(this,["keydown",t].concat(r))},onKeyUp:function(t){this.stop(),this.recordCursorPosition();for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.__emit.apply(this,["keyup",t].concat(n))},onChange:function(t){this.$data.focused&&(this.inputting=!0),this.rawInput=this.parser(this.getValueFromEvent(t)),this.setState({inputValue:this.rawInput});var e=this.toNumber(this.rawInput);this.__emit("update:value",e),this.__emit("change",e)},onFocus:function(){this.setState({focused:!0});for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.__emit.apply(this,["focus"].concat(e))},onBlur:function(){this.inputting=!1,this.setState({focused:!1});var t=this.getCurrentValidValue(this.$data.inputValue),e=this.setValue(t);if(this.$attrs.onBlur){var n=this.inputRef.value,i=this.getInputDisplayValue({focused:!1,sValue:e});this.inputRef.value=i;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];this.__emit.apply(this,["blur"].concat(s)),this.inputRef.value=n}},getCurrentValidValue:function(t){var e=t;return e=""===e?"":this.isNotCompleteNumber(parseFloat(e,10))?this.$data.sValue:this.getValidValue(e),this.toNumber(e)},getRatio:function(t){var e=1;return t.metaKey||t.ctrlKey?e=.1:t.shiftKey&&(e=10),e},getValueFromEvent:function(t){var e=t.target.value.trim().replace(/。/g,".");return j(this.decimalSeparator)&&(e=e.replace(this.decimalSeparator,".")),e},getValidValue:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.min,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.max,i=parseFloat(t,10);return isNaN(i)?t:(i<e&&(i=e),i>n&&(i=n),i)},setValue:function(t,e){var n=this.$props.precision,i=this.isNotCompleteNumber(parseFloat(t,10))?null:parseFloat(t,10),r=this.$data,s=r.sValue,o=void 0===s?null:s,a=r.inputValue,u=void 0===a?null:a,c="number"==typeof i?i.toFixed(n):"".concat(i),l=i!==o||c!=="".concat(u);return p(this,"value")?this.setState({inputValue:this.toPrecisionAsStep(this.$data.sValue)},e):this.setState({sValue:i,inputValue:this.toPrecisionAsStep(t)},e),l&&(this.__emit("update:value",i),this.__emit("change",i)),i},getPrecision:function(t){if(j(this.precision))return this.precision;var e=t.toString();if(e.indexOf("e-")>=0)return parseInt(e.slice(e.indexOf("e-")+2),10);var n=0;return e.indexOf(".")>=0&&(n=e.length-e.indexOf(".")-1),n},getMaxPrecision:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(j(this.precision))return this.precision;var n=this.step,i=this.getPrecision(e),r=this.getPrecision(n),s=this.getPrecision(t);return t?Math.max(s,i+r):i+r},getPrecisionFactor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getMaxPrecision(t,e);return Math.pow(10,n)},getInputDisplayValue:function(t){var e,n=t||this.$data,i=n.focused,r=n.inputValue,s=n.sValue;null==(e=i?r:this.toPrecisionAsStep(s))&&(e="");var o=this.formatWrapper(e);return j(this.$props.decimalSeparator)&&(o=o.toString().replace(".",this.$props.decimalSeparator)),o},recordCursorPosition:function(){try{var t=this.inputRef;this.cursorStart=t.selectionStart,this.cursorEnd=t.selectionEnd,this.currentValue=t.value,this.cursorBefore=t.value.substring(0,this.cursorStart),this.cursorAfter=t.value.substring(this.cursorEnd)}catch(t){}},fixCaret:function(t,e){if(void 0!==t&&void 0!==e&&this.inputRef&&this.inputRef.value)try{var n=this.inputRef,i=n.selectionStart,r=n.selectionEnd;t===i&&e===r||n.setSelectionRange(t,e)}catch(t){}},restoreByAfter:function(t){if(void 0===t)return!1;var e=this.inputRef.value,n=e.lastIndexOf(t);if(-1===n)return!1;var i=this.cursorBefore.length;return this.lastKeyCode===h.DELETE&&this.cursorBefore.charAt(i-1)===t[0]?(this.fixCaret(i,i),!0):n+t.length===e.length&&(this.fixCaret(n,n),!0)},partRestoreByAfter:function(t){var e=this;return void 0!==t&&Array.prototype.some.call(t,(function(n,i){var r=t.substring(i);return e.restoreByAfter(r)}))},focus:function(){this.inputRef.focus(),this.recordCursorPosition()},blur:function(){this.inputRef.blur()},formatWrapper:function(t){return this.formatter?this.formatter(t):t},toPrecisionAsStep:function(t){if(this.isNotCompleteNumber(t)||""===t)return t;var e=Math.abs(this.getMaxPrecision(t));return isNaN(e)?t.toString():Number(t).toFixed(e)},isNotCompleteNumber:function(t){return isNaN(t)||""===t||null===t||t&&t.toString().indexOf(".")===t.toString().length-1},toNumber:function(t){var e=this.$props,n=e.precision,i=e.autofocus,r=this.$data.focused,s=void 0===r?i:r,o=t&&t.length>16&&s;return this.isNotCompleteNumber(t)||o?t:j(n)?Math.round(t*Math.pow(10,n))/Math.pow(10,n):Number(t)},upStep:function(t,e){var n=this.step,i=this.getPrecisionFactor(t,e),r=Math.abs(this.getMaxPrecision(t,e)),s=((i*t+i*n*e)/i).toFixed(r);return this.toNumber(s)},downStep:function(t,e){var n=this.step,i=this.getPrecisionFactor(t,e),r=Math.abs(this.getMaxPrecision(t,e)),s=((i*t-i*n*e)/i).toFixed(r);return this.toNumber(s)},stepFn:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0;if(this.stop(),e&&e.preventDefault(),!this.disabled){var s=this.max,o=this.min,a=this.getCurrentValidValue(this.$data.inputValue)||0;if(!this.isNotCompleteNumber(a)){var u=this["".concat(t,"Step")](a,i),c=u>s||u<o;u>s?u=s:u<o&&(u=o),this.setValue(u),this.setState({focused:!0}),c||(this.autoStepTimer=setTimeout((function(){n[t](e,i,!0)}),r?200:600))}}},stop:function(){this.autoStepTimer&&clearTimeout(this.autoStepTimer)},down:function(t,e,n){this.pressingUpOrDown=!0,this.stepFn("down",t,e,n)},up:function(t,e,n){this.pressingUpOrDown=!0,this.stepFn("up",t,e,n)},handleInputClick:function(){this.__emit("click")},saveUp:function(t){this.upHandlerRef=t},saveDown:function(t){this.downHandlerRef=t},saveInput:function(t){this.inputRef=t}},render:function(){var t,e=N(N({},this.$props),this.$attrs),n=e.prefixCls,i=e.disabled,r=e.readonly,s=e.useTouch,a=e.autocomplete,c=e.upHandler,l=e.downHandler,h=e.class,p=o((M(t={},h,h),M(t,n,!0),M(t,"".concat(n,"-disabled"),i),M(t,"".concat(n,"-focused"),this.$data.focused),t)),f="",d="",v=this.$data.sValue;if(v||0===v)if(isNaN(v))f="".concat(n,"-handler-up-disabled"),d="".concat(n,"-handler-down-disabled");else{var m=Number(v);m>=this.max&&(f="".concat(n,"-handler-up-disabled")),m<=this.min&&(d="".concat(n,"-handler-down-disabled"))}var b={};for(var g in e)!e.hasOwnProperty(g)||"data-"!==g.substr(0,5)&&"aria-"!==g.substr(0,5)&&"role"!==g||(b[g]=e[g]);var y,O,w=!this.readonly&&!this.disabled,x=this.getInputDisplayValue();s?(y={onTouchstart:w&&!f&&this.up,onTouchend:this.stop},O={onTouchstart:w&&!d&&this.down,onTouchend:this.stop}):(y={onMousedown:w&&!f&&this.up,onMouseup:this.stop,onMouseleave:this.stop},O={onMousedown:w&&!d&&this.down,onMouseup:this.stop,onMouseleave:this.stop});var C=!!f||i||r,S=!!d||i||r,E=N(N({disabled:C,prefixCls:n,unselectable:"unselectable",role:"button","aria-label":"Increase Value","aria-disabled":!!C,class:"".concat(n,"-handler ").concat(n,"-handler-up ").concat(f)},y),{ref:this.saveUp}),j=N(N({disabled:S,prefixCls:n,unselectable:"unselectable",role:"button","aria-label":"Decrease Value","aria-disabled":!!S,class:"".concat(n,"-handler ").concat(n,"-handler-down ").concat(d)},O),{ref:this.saveDown});return u("div",{class:p,style:e.style,title:e.title,onMouseenter:e.onMouseenter,onMouseleave:e.onMouseleave,onMouseover:e.onMouseover,onMouseout:e.onMouseout},[u("div",{class:"".concat(n,"-handler-wrap")},[u("span",null,[u(P,V(V({},E),{},{key:"upHandler"}),{default:function(){return[c||u("span",{unselectable:"unselectable",class:"".concat(n,"-handler-up-inner"),onClick:T},null)]}})]),u(P,V(V({},j),{},{key:"downHandler"}),{default:function(){return[l||u("span",{unselectable:"unselectable",class:"".concat(n,"-handler-down-inner"),onClick:T},null)]}})]),u("div",{class:"".concat(n,"-input-wrap")},[u("input",V({role:"spinbutton","aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":v,required:this.required,type:e.type,placeholder:this.placeholder,onClick:this.handleInputClick,class:"".concat(n,"-input"),tabindex:this.tabindex,autocomplete:a,onFocus:this.onFocus,onBlur:this.onBlur,onKeydown:w&&this.onKeyDown,onKeyup:w&&this.onKeyUp,autofocus:this.autofocus,maxlength:this.maxlength,readonly:this.readonly,disabled:this.disabled,max:this.max,min:this.min,step:this.step,name:this.name,title:this.title,id:this.id,onInput:this.onChange,ref:this.saveInput,value:x,pattern:this.pattern},b),null)])])}});function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R(){return(R=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var k=f(e({name:"AInputNumber",inheritAttrs:!1,props:{prefixCls:t.string,min:t.number,max:t.number,value:t.oneOfType([t.number,t.string]),step:t.oneOfType([t.number,t.string]).def(1),defaultValue:t.oneOfType([t.number,t.string]),tabindex:t.number,disabled:t.looseBool,size:t.oneOf(d("large","small","default")),formatter:t.func,parser:t.func,decimalSeparator:t.string,placeholder:t.string,name:t.string,id:t.string,precision:t.number,autofocus:t.looseBool,onPressEnter:{type:Function},onChange:Function},setup:function(t){var e=v(null);return m((function(){b((function(){}))})),{configProvider:g("configProvider",y),inputNumberRef:e,focus:function(){e.value.focus()},blur:function(){e.value.blur()}}},render:function(){var t,e=R(R({},l(this)),this.$attrs),n=e.prefixCls,i=e.size,r=e.class,s=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["prefixCls","size","class"]),a=(0,this.configProvider.getPrefixCls)("input-number",n),c=o((F(t={},"".concat(a,"-lg"),"large"===i),F(t,"".concat(a,"-sm"),"small"===i),t),r),h=R(R({prefixCls:a,upHandler:u(w,{class:"".concat(a,"-handler-up-inner")},null),downHandler:u(O,{class:"".concat(a,"-handler-down-inner")},null)},s),{class:c});return u(_,$($({},h),{},{ref:"inputNumberRef"}),null)}}));export{k as I};